!function(e){function t(t){for(var a,l,o=t[0],c=t[1],u=t[2],d=0,p=[];d<o.length;d++)l=o[d],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&p.push(r[l][0]),r[l]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(s&&s(t);p.length;)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(a=!1)}a&&(i.splice(t--,1),e=l(l.s=n[0]))}return e}var a={},r={4:0},i=[];function l(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,a){n=r[e]=[t,a]}));t.push(n[2]=a);var i,o=document.createElement("script");o.charset="utf-8",o.timeout=120,l.nc&&o.setAttribute("nonce",l.nc),o.src=function(e){return l.p+""+({5:"tracker"}[e]||e)+".bundle.js"}(e);var c=new Error;i=function(t){o.onerror=o.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,n[1](c)}r[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:o})}),12e4);o.onerror=o.onload=i,document.head.appendChild(o)}return Promise.all(t)},l.m=e,l.c=a,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(n,a,function(t){return e[t]}.bind(null,a));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var s=c;i.push([225,0]),n()}({225:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(28),l=n(21),o=n(1),c=n.n(o),u=n(18),s=n.n(u),d=n(10),p=n.n(d),m=n(2),f=n.n(m),g=n(52),b=n(62),h=n(3),E=function(e,t){switch(t.type){case"selectSingle":return e.includes(t.id)?e.filter((function(e){return e!==t.id})):[].concat(p()(e),[t.id]);case"selectAll":return e.length===t.list.length?[]:t.list;default:return e}},y=function(e){var t=e.filter((function(e){var t=e.links;return Object(h.t)(t)})).map((function(e){return e.id})),n=Object(a.useReducer)(E,t),r=f()(n,2),i=r[0],l=r[1];return{checked:i.length===t.length,selections:i,selectAll:function(){l({type:"selectAll",list:t})},selectSingle:function(e){l({type:"selectSingle",id:e})}}},v=n(15),O=n(48),j=function(e){var t=e.id,n=e.attributes,a=e.relationships,r=e.links,i=n.label,l=n.totalCount,o=a.dependencies,c=a.consistsOf;return{id:t,label:i,totalCount:l,dependencies:o.data.map((function(e){return{id:e.id}})),consistsOf:c.data.map((function(e){return{id:e.id}})),links:r}},k=r.a.createContext({}),w=function(e){var t=e.source,n=e.children,i=Object(a.useState)([]),l=f()(i,2),o=l[0],c=l[1],u=Object(a.useState)({}),s=f()(u,2),d=s[0],p=s[1],m=Object(a.useContext)(v.c).throwError,g=Object(b.a)(d).bulkUpdateMigrations,h=Object(O.b)({href:t,handleError:m}),E=h.isLoading,y=h.document;return Object(a.useEffect)((function(){y&&(p(y.links),c(y.data.map(j)))}),[y]),r.a.createElement(k.Provider,{value:{links:d,migrations:o,isLoading:E,bulkUpdateMigrations:g}},n)};w.propTypes={source:c.a.string.isRequired,children:c.a.oneOfType([c.a.arrayOf(c.a.node),c.a.node]).isRequired};var S=function(){var e=Object(u.useTracking)(),t=Object(a.useState)(!1),n=f()(t,2),i=n[0],l=n[1],o=Object(a.useState)(new Set),c=f()(o,2),s=c[0],d=c[1],m=Object(a.useState)(new Set),E=f()(m,2),v=E[0],O=E[1],j=Object(a.useContext)(k),w=j.migrations,S=j.links,_=Object(b.a)(),C=_.setLink,N=_.bulkUpdateMigrations,L=y(w),M=L.checked,P=L.selections,x=L.selectAll,A=L.selectSingle,D=w.reduce((function(e,t){return e[+P.includes(t.id)].push(t),e}),[[],[]]),R=f()(D,2),T=R[0],q=R[1],U=[{label:"Selected",count:P.length,modifier:"primary",description:r.a.createElement("span",null,r.a.createElement("strong",null,"Selected")," refers to migrations that you plan to run.")},{label:"Required",count:p()(s).filter((function(e){return!P.includes(e)})).length,modifier:"secondary",description:r.a.createElement("span",null,r.a.createElement("strong",null,"Required")," are dependencies of selected migrations.")},{label:"Skipped",count:T.length,modifier:"warning",description:r.a.createElement("span",{className:"migration__import-status-desc migration__warning"},"Migrations with ",r.a.createElement("strong",null,"0")," items are ",r.a.createElement("strong",null,"skipped")," ","by default, but you can choose to skip any others that you do not wish to import now.")}];return Object(a.useEffect)((function(){Object.values(S).length&&Object(h.s)(S)&&C(Object(h.j)(S)[0])}),[S]),Object(a.useEffect)((function(){d(P.reduce((function(e,t){return Object(h.a)(Object(h.f)(t,w),w).forEach((function(t){return e.add(t)})),e}),new Set))}),[P]),Object(a.useEffect)((function(){O(new Set([].concat(p()(s),p()(P))))}),[P,s]),r.a.createElement("form",{className:"preselect__list"},r.a.createElement("div",null,r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement(g.a,{id:"allMigrations",options:{checked:M,disabled:!1},toggle:x})),r.a.createElement("th",null,"Name"),r.a.createElement("th",{style:{"min-width":"6rem"}},"Number of Items"),r.a.createElement("th",null,"Dependencies"))),r.a.createElement("tbody",null,w.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(g.a,{id:e.id,options:{checked:P.includes(e.id)||s.has(e.id),disabled:Object(h.u)(e.links)||s.has(e.id)},toggle:function(){A(e.id)}})),r.a.createElement("td",null,e.label),r.a.createElement("td",{className:"col--align"},0!==e.totalCount&&P.includes(e.id)?r.a.createElement("span",null,e.totalCount):r.a.createElement("span",{className:"migration__import-status migration__warning",title:"".concat(0===e.totalCount?"Migrations with 0 items are skipped by default":"".concat(e.totalCount," migrations will be skipped."))},e.totalCount)),r.a.createElement("td",null,Object(h.b)(e,w).map((function(e){return e.label})).join(", ")))}))))),r.a.createElement("div",{className:"preselect__start"},r.a.createElement("button",{type:"submit",disabled:i||0===v.size,className:"button button--primary",onClick:function(t){t.preventDefault(),l(!0);var n=Date.now();e.trackEvent({type:"Preselect started",preconfigSelectedQuantity:q.length,preconfigSkippedQuantity:T.length,preconfigSelectedRows:Object(h.G)(q,"totalCount"),preconfigSkippedRows:Object(h.G)(T,"totalCount"),preconfigSelectedList:q.map((function(e){return e.id})),preconfigSkippedList:T.map((function(e){return e.id})),preconfigSelectedUnderlyingList:Object(h.w)(q),preconfigSkippedUnderlyingList:Object(h.w)(T)}),N(w.map((function(e){var t=e.id;return{type:"migration",id:t,attributes:{skipped:!v.has(t)}}}))).then((function(t){e.trackEvent({type:"Preselect completed",preconfigDuration:Date.now()-n})}))}},"Start Migration"),v.size>0?r.a.createElement("strong",null,"(",v.size,") Selected items"):r.a.createElement("span",null,"No migrations selected")),r.a.createElement("div",{className:"panel panel--info"},r.a.createElement("div",{className:"panel__content"},r.a.createElement("div",{className:"preselection_summary"},U.filter((function(e){return e.count>0})).map((function(e){return r.a.createElement("div",{key:"".concat(e.label,"--count")},r.a.createElement("span",{className:"preselection_summary__count"},e.count),r.a.createElement("span",{className:"preselection_summary__label"},e.label))}))),U.filter((function(e){return e.count>0})).map((function(e){return r.a.createElement("p",{key:"".concat(e.label,"--desc")},e.description)})))))},_=n(25),C=function(){var e=Object(a.useContext)(k),t=e.migrations,n=e.links,i=e.isLoading;return t.length?Object(h.s)(n)?r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("p",null,"Choose which parts of your source site you want to migrate into your new Drupal 9 site."),r.a.createElement("p",null,r.a.createElement("em",null,"Don't worry"),", you can still choose to bring over anything later that you skip now.")),r.a.createElement(S,null)):r.a.createElement("div",null,r.a.createElement("p",null,"Preselections made successfully."),Object(h.r)(n)?r.a.createElement("p",null,"Visit the dashboard to begin an initial import of supporting configuration. When that is complete, you may begin importing content."):r.a.createElement("p",null,"The initial import of your selected migrations is complete, you no longer need to visit this page."),r.a.createElement("a",{className:"button button--primary",href:"/upgrade/migrations"},"View Migrations Dashboard")):r.a.createElement("div",null,i?r.a.createElement(_.a,{message:"Loadingâ€¦"}):r.a.createElement("p",null,"No migrations available."))},N=n(29),L=n(30),M=function(e){var t=e.basepath,n=e.source;return r.a.createElement(w,{basepath:t,source:n},r.a.createElement("div",{className:"migrate-ui"},r.a.createElement(N.a,null,r.a.createElement(L.a,{title:"Select data to migrate"})),r.a.createElement("div",null,r.a.createElement(C,null))))},P=new l.a,x=s()({},{dispatch:function(e){return P.logEvent(e)}})(M);M.propTypes={basepath:c.a.string.isRequired,source:c.a.string.isRequired};var A=n(46);document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector("#decoupled-page-root"),t=e.getAttribute("data-module-path");n.p="/".concat(t,"/ui/dist/");var a=e.getAttribute("data-basepath"),o=e.getAttribute("data-source");(new l.a).init(e.getAttribute("data-tracking-api-key"),Object(A.a)(e),void 0),e&&Object(i.render)(r.a.createElement(x,{basepath:a,source:o}),e)}))}});